# [리눅스] Bash trap 사용법

## 概要
`trap` コマンドは、シェルスクリプトやコマンドラインで特定のシグナルを捕捉し、それに対して指定したコマンドを実行するために使用されます。主に、スクリプトが終了する際や、特定のシグナル（例：SIGINTやSIGTERM）を受け取ったときに、クリーンアップ処理や後処理を行うために利用されます。

## 使用法
`trap` コマンドの基本的な構文は以下の通りです。

```bash
trap 'commands' SIGNALS
```

- `commands`: シグナルを受け取ったときに実行されるコマンドや処理を指定します。
- `SIGNALS`: 捕捉したいシグナルを指定します。複数のシグナルを指定することも可能です。

一般的なシグナルには以下のようなものがあります：
- `SIGINT`: Ctrl+C で送信される中断シグナル
- `SIGTERM`: プロセス終了要求シグナル
- `EXIT`: スクリプトが終了する際に実行される

## 例
以下に、`trap` コマンドの実用的な例を示します。

### 例1: SIGINT シグナルの捕捉

```bash
#!/bin/bash

trap 'echo "中断されました"; exit' SIGINT

while true; do
    echo "スクリプトが実行中..."
    sleep 1
done
```

このスクリプトは、無限ループを実行し続けますが、Ctrl+C を押すと「中断されました」と表示され、スクリプトが終了します。

### 例2: EXIT シグナルの使用

```bash
#!/bin/bash

trap 'echo "スクリプトが終了します"; cleanup_function' EXIT

cleanup_function() {
    echo "クリーンアップ処理を実行中..."
}

echo "スクリプトが実行中..."
sleep 5
```

このスクリプトでは、スクリプトが終了する際にクリーンアップ処理を実行します。

## ヒント
- `trap` を使用することで、スクリプトの信頼性を向上させることができます。特に、リソースの解放やファイルのクリーンアップを行う際に役立ちます。
- 複数のシグナルを同時に捕捉することができるため、必要に応じてシグナルを組み合わせて使用してください。
- `trap` コマンドを使用する際は、シグナルが発生する可能性のある箇所で適切に設定することが重要です。