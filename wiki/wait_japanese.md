# [리눅스] Bash wait 사용법

## 概要
`wait` コマンドは、Bash スクリプトやシェルで実行中のバックグラウンドプロセスが終了するのを待つために使用されます。このコマンドの主な目的は、特定のプロセスが完了するまでスクリプトの実行を一時停止することです。これにより、プロセスの結果を取得したり、依存関係のある処理を順序立てて実行することが可能になります。

## 使用法
基本的な構文は以下の通りです。

```bash
wait [PID]
```

- `PID`: 待機するプロセスのプロセスID（オプション）。指定しない場合、すべてのバックグラウンドプロセスの終了を待ちます。

### 一般的なオプション
- `-n`: 最後に終了したバックグラウンドプロセスの終了を待ちます。
- `-p`: 指定したプロセスの終了を待ち、終了ステータスを返します。

## 例
### 例 1: バックグラウンドプロセスの待機
以下のスクリプトでは、2つのバックグラウンドプロセスを実行し、両方のプロセスが終了するまで待機します。

```bash
#!/bin/bash

sleep 5 &
pid1=$!
sleep 3 &
pid2=$!

wait $pid1
echo "プロセス1が終了しました。"

wait $pid2
echo "プロセス2が終了しました。"
```

### 例 2: すべてのバックグラウンドプロセスを待機
次の例では、バックグラウンドで実行されるすべてのプロセスが終了するのを待ちます。

```bash
#!/bin/bash

sleep 2 &
sleep 4 &
sleep 1 &

wait
echo "すべてのバックグラウンドプロセスが終了しました。"
```

## ヒント
- `wait` コマンドを使用する際は、バックグラウンドプロセスの PID を保存しておくと、特定のプロセスの終了を待つことができ、より柔軟なスクリプトを作成できます。
- スクリプトの実行中にエラーが発生した場合、`wait` コマンドはそのエラーを検出し、適切に処理するための条件分岐を追加することをお勧めします。
- `wait` コマンドは、スクリプトのデバッグにも役立ちます。バックグラウンドプロセスの実行時間を測定するために、`wait` の前後にタイムスタンプを追加することができます。