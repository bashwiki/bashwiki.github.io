# [리눅스] Bash timeout 사용법

## 概述
`timeout` 命令用于限制其他命令的执行时间。它会在指定的时间段后终止运行的命令，通常用于防止某些进程无限期地运行，确保系统资源的有效利用。通过使用 `timeout`，开发人员和工程师可以更好地控制脚本的执行时间，避免因长时间运行的命令而导致的系统阻塞。

## 用法
`timeout` 命令的基本语法如下：

```bash
timeout [选项] <时间> <命令> [<参数>...]
```

### 常用选项
- `<时间>`：指定命令允许运行的最大时间，可以使用后缀来表示单位，例如：
  - `s`：秒（默认）
  - `m`：分钟
  - `h`：小时
  - `d`：天
- `-k <时间>`：在超时后，允许命令继续运行的时间，直到强制终止。
- `--preserve-status`：保留被终止命令的退出状态，默认情况下，`timeout` 会返回 124 作为超时的状态码。

## 示例
### 示例 1：限制命令运行时间
以下命令将运行 `sleep 10`，并在 5 秒后强制终止：

```bash
timeout 5s sleep 10
```
在这个例子中，`sleep` 命令会在 5 秒后被终止，尽管它原本会运行 10 秒。

### 示例 2：使用 `-k` 选项
以下命令会在 5 秒后终止 `sleep 10`，但在终止后再等待 2 秒强制结束：

```bash
timeout -k 2s 5s sleep 10
```
在这个例子中，`sleep` 命令将在 5 秒后被终止，但如果它没有在 2 秒内结束，`timeout` 将强制终止它。

## 提示
- 在使用 `timeout` 时，建议根据实际需要合理设置超时时间，以避免不必要的强制终止。
- 使用 `--preserve-status` 选项可以帮助调试脚本，因为它允许你获取被终止命令的退出状态。
- 在编写自动化脚本时，考虑使用 `timeout` 来确保脚本的健壮性，避免因单个命令的失败而导致整个脚本的挂起。